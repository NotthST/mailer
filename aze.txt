# Remove matplotlib so its hook stops running
pip uninstall -y matplotlib contourpy cycler fonttools kiwisolver pillow

# Pin numpy / pandas to versions that bundle cleanly with PyInstaller
pip install --upgrade "numpy==1.26.4" "pandas==2.1.3" "openpyxl==3.1.2" "pyinstaller==6.10.0"




pyinstaller ^
  --name ReleaseComms ^
  --onedir ^
  --noconsole ^
  --exclude-module matplotlib ^
  --exclude-module matplotlib.backends ^
  --collect-all numpy ^
  --collect-all pandas ^
  --add-data "config.ini;." ^
  app.py


rmdir /s /q build dist 2>$null

pyinstaller ^
  --name ReleaseComms ^
  --onefile ^
  --noconsole ^
  --exclude-module matplotlib ^
  --exclude-module matplotlib.backends ^
  --collect-all numpy ^
  --collect-all pandas ^
  --runtime-tmpdir "%LOCALAPPDATA%\PyAppTemp\ReleaseComms" ^
  --add-data "config.ini;." ^
  app.py
